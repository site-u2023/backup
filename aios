#!/bin/sh
# License: CC0
# OpenWrt >= 19.07

BASE_URL="https://raw.githubusercontent.com/site-u2023/aios/main/"
BASE_DIR="/tmp/aios/"
SUPPORTED_VERSIONS="19 21 22 23 24 SN"

banner() {
echo -e "$(color "red_white" "    Disclaimer: Use this script at your own risk.     ")"

echo -e "$(color "white"     "     Dedicated configuration software for OpenWrt     ")"ã€€
echo -e "$(color "white"     "                                                      ")"
echo -e "$(color "magenta"   "                    ii i                              ")"
echo -e "$(color "blue"      "         aaaa      iii       oooo      sssss          ")"
echo -e "$(color "cyan"      "            aa      ii      oo  oo    ss              ")"
echo -e "$(color "green"     "         aaaaa      ii      oo  oo     sssss          ")"
echo -e "$(color "yellow"    "        aa  aa      ii      oo  oo         ss         ")"
echo -e "$(color "red"       "         aaaaa     iiii      oooo     ssssss          ")"
echo -e "$(color "white"     "                                                      ")"
echo -e "$(color "white"     "                  all in one scripts                  ")"
echo -e "$(color "white"     "                                                      ")"
}

make_directory() {
mkdir -p "$BASE_DIR" || {
    echo "Failed to create BASE_DIR: $BASE_DIR"
    exit 1
    }
}

download_and_execute_common() {
wget --no-check-certificate -O "${BASE_DIR}/common-functions.sh" "${BASE_URL}common-functions.sh" || {
    echo "Failed to download common-functions.sh"
    source "${BASE_DIR}common-functions.sh"
    exit 1
    }
}

download_and_execute_openwrt_config() {
wget --no-check-certificate -O "${BASE_DIR}/openwrt-config.sh" "${BASE_URL}openwrt-config.sh" || {
    echo "Failed to download openwrt-config.sh"
    sh "${BASE_DIR}openwrt-config.sh"
    exit 1
    }
}

make_directory
download_and_execute_common
check_common "$1"
banner
download_and_execute_openwrt_config
